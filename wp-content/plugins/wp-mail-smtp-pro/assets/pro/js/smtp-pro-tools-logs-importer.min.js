"use strict";var WPMailSMTP=window.WPMailSMTP||{};WPMailSMTP.Admin=WPMailSMTP.Admin||{},WPMailSMTP.Admin.Tools=WPMailSMTP.Admin.Tools||{},WPMailSMTP.Admin.Tools.LogsImporter=WPMailSMTP.Admin.Tools.LogsImporter||function(o){var i={$resultNoticeSection:o("#wp-mail-smtp-log-importer-result-notice"),$resultNoticeTextSection:o("#wp-mail-smtp-log-importer-result-notice > p"),$importButton:o("#wp-mail-smtp-tools-log-importer-button"),$importButtonTxt:o("#wp-mail-smtp-tools-log-importer-button > .wp-mail-smtp-btn-text"),$importButtonSpinner:o("#wp-mail-smtp-tools-log-importer-button > .wp-mail-smtp-btn-spinner"),$importLoader:o("#wp-mail-smtp-tools-log-importer-loader"),$descriptionSection:o("#wp-mail-smtp-pro-import-description-section"),$importedLogsCount:o(".wp-mail-smtp-pro-importer-imported-logs-count"),$logsToImportCount:o(".wp-mail-smtp-pro-importer-logs-to-import-count"),$importProgressSection:o("#wp-mail-smtp-pro-import-progress-section"),$summarySection:o("#wp-mail-smtp-pro-import-summary"),$summarySuccessCount:o("#wp-mail-smtp-pro-import-summary-success-count"),$summaryFailedCount:o("#wp-mail-smtp-pro-import-summary-failed-count"),$summaryAttachmentFailedCount:o("#wp-mail-smtp-pro-import-summary-attachment-failed-count")},e={successfulImportCount:0,failedImportCount:0,failedAttachmentCount:0,errorMessages:[],failedImportIds:[]},s=1,r=2,n=3,m={init:function(){o(m.ready)},ready:function(){m.setupUI(),m.bindActions()},setupUI:function(){i.$logsToImportCount.text(wp_mail_smtp_tools_importer.logs_to_import_count)},bindActions:function(){i.$importButton.on("click",m.initializeImportProcess)},initializeImportProcess:function(t){t.preventDefault(),i.$importButton.prop("disabled",!0),i.$importButton.hide(),i.$importLoader.show(),m.sendAjaxRequest()},sendAjaxRequest:function(){var t={action:"wp_mail_smtp_importer_ajax_wp_mail_logging_importer",nonce:wp_mail_smtp_tools_importer.nonce};o.post(wp_mail_smtp.ajax_url,t,function(t){if(m.handleResponse(t.data),t.success){if(!0===t.data.continue)return m.updateProgressSection(),void m.sendAjaxRequest();m.importDone(),m.showSummary()}else m.handleErrors(t.data)})},handleResponse:function(t){t.successful_import_count&&(e.successfulImportCount+=parseInt(t.successful_import_count,10)),t.failed_import_count&&(e.failedImportCount+=parseInt(t.failed_import_count,10)),t.failed_attachment_count&&(e.failedAttachmentCount+=parseInt(t.failed_attachment_count,10))},handleErrors:function(t){t.error_message&&(e.errorMessages.push(t.error_message),m.importDone(),m.showResultNotice(n,e.errorMessages.join(".")))},updateProgressSection:function(){i.$importedLogsCount.text(e.successfulImportCount),i.$importProgressSection.show()},importDone:function(){i.$descriptionSection.hide(),i.$importProgressSection.hide(),i.$importLoader.hide()},showSummary:function(){e.failedImportCount+e.failedAttachmentCount===parseInt(wp_mail_smtp_tools_importer.logs_to_import_count,10)?(m.setupSummary(),m.showResultNotice(n),i.$summarySection.show()):0<e.failedImportCount||0<e.failedAttachmentCount?(m.setupSummary(),m.showResultNotice(r),i.$summarySection.show()):m.showResultNotice(s)},setupSummary:function(){i.$summarySuccessCount.text(e.successfulImportCount),i.$summaryFailedCount.text(e.failedImportCount),i.$summaryAttachmentFailedCount.text(e.failedAttachmentCount)},showResultNotice:function(t,o=""){var e="";switch(t){case s:i.$resultNoticeSection.addClass("notice-success"),e=wp_mail_smtp_tools_importer.notice_success;break;case r:i.$resultNoticeSection.addClass("notice-warning"),e=wp_mail_smtp_tools_importer.notice_warning;break;case n:i.$resultNoticeSection.addClass("notice-error"),e=wp_mail_smtp_tools_importer.notice_fail}t=e;""!==o&&(t+=" "+o),i.$resultNoticeTextSection.text(t),i.$resultNoticeSection.show()}};return m}((document,window,jQuery)),WPMailSMTP.Admin.Tools.LogsImporter.init();